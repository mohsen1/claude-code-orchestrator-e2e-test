{
  "version": 1,
  "issue": {
    "number": 46,
    "title": "Task Management API with SQLite",
    "body": "## Overview\nBuild a complete Task Management REST API with persistent storage.\n\n## Requirements\n\n### Core Features\n1. **Task CRUD Operations**\n   - Create task with title, description, due date, priority (low/medium/high)\n   - Read single task and list all tasks\n   - Update task fields\n   - Delete task (soft delete with archived flag)\n\n2. **SQLite Database**\n   - Use better-sqlite3 for synchronous SQLite\n   - Create tasks table with proper schema\n   - Include created_at, updated_at timestamps\n\n3. **Express Server**\n   - RESTful routes: GET/POST/PUT/DELETE /api/tasks\n   - Input validation middleware\n   - Error handling middleware\n   - JSON response formatting\n\n### Technical Requirements\n- TypeScript with strict mode\n- Zod for request validation\n- Proper HTTP status codes (200, 201, 400, 404, 500)\n- Environment variable for database path\n- Export functions for testing\n\n### File Structure\n```\nsrc/\n  index.ts          # Main entry, server setup\n  db.ts             # Database initialization\n  routes/\n    tasks.ts        # Task routes\n  models/\n    task.ts         # Task type definitions\n  middleware/\n    validation.ts   # Request validation\n    error.ts        # Error handling\n```\n\n## Acceptance Criteria\n- Server starts on PORT env var or 3000\n- All CRUD operations work correctly\n- Invalid requests return 400 with error message\n- Missing tasks return 404\n- Database persists between restarts"
  },
  "repo": {
    "owner": "mohsen1",
    "name": "claude-code-orchestrator-e2e-test"
  },
  "phase": "failed",
  "workBranch": "cco/46-task-management-api-with-sqlite",
  "baseBranch": "main",
  "ems": [
    {
      "id": 1,
      "task": "Implement SQLite database layer with task model and schema definitions",
      "focusArea": "Data Layer",
      "branch": "cco/issue-46-em-1",
      "status": "pr_created",
      "workers": [
        {
          "id": 1,
          "task": "Create database initialization and task model with TypeScript types. Define Task interface with id, title, description, due_date, priority, created_at, updated_at, and archived fields. Implement Database class using better-sqlite3 with methods: initialize() to create tasks table, getAllTasks() to select all non-archived rows, getTaskById(id) to select single row, createTask(task) to insert row, updateTask(id, task) to update row, and deleteTask(id) to soft delete by setting archived=1. Export db instance and Task type.",
          "files": [
            "src/models/task.ts",
            "src/db.ts"
          ],
          "branch": "cco/issue-46-em-1-w-1",
          "status": "merged",
          "reviewsAddressed": 0,
          "startedAt": "2026-01-19T22:22:00.757Z",
          "prNumber": 47,
          "prUrl": "https://github.com/mohsen1/claude-code-orchestrator-e2e-test/pull/47",
          "completedAt": "2026-01-19T22:23:07.303Z"
        },
        {
          "id": 2,
          "task": "Implement validation and error middleware. Create Zod schemas for task validation: createTaskSchema with required title (string), optional description (string), optional due_date (ISO date string), and optional priority (enum: 'low'|'medium'|'high'). Update schema should be partial version of createTaskSchema. Create validateRequest middleware factory that takes a schema and validates req.body, returning 400 with {error: string} on failure. Create errorHandler middleware that catches errors and returns 500 with {error: string}. Export both middleware.",
          "files": [
            "src/middleware/validation.ts",
            "src/middleware/error.ts"
          ],
          "branch": "cco/issue-46-em-1-w-2",
          "status": "pr_created",
          "reviewsAddressed": 0,
          "startedAt": "2026-01-19T22:23:07.889Z",
          "prNumber": 48,
          "prUrl": "https://github.com/mohsen1/claude-code-orchestrator-e2e-test/pull/48",
          "completedAt": "2026-01-19T22:25:41.105Z"
        },
        {
          "id": 3,
          "task": "Create Express server with task routes. Import Router from express, db from db.ts, and validateRequest from validation.ts. Define routes: GET /api/tasks - calls db.getAllTasks() and returns JSON array; GET /api/tasks/:id - calls db.getTaskById(id), returns 404 if not found, else returns JSON object; POST /api/tasks - uses validateRequest(createTaskSchema), calls db.createTask(), returns 201 with created task; PUT /api/tasks/:id - uses validateRequest(updateTaskSchema), calls db.updateTask(), returns 404 if not found, else returns updated task; DELETE /api/tasks/:id - calls db.deleteTask(), returns 404 if not found, else returns 200. In src/index.ts, create Express app, use JSON parser, register task routes at /api/tasks, use errorHandler middleware, listen on PORT env var or 3000.",
          "files": [
            "src/routes/tasks.ts",
            "src/index.ts"
          ],
          "branch": "cco/issue-46-em-1-w-3",
          "status": "pr_created",
          "reviewsAddressed": 0,
          "startedAt": "2026-01-19T22:25:41.662Z",
          "prNumber": 49,
          "prUrl": "https://github.com/mohsen1/claude-code-orchestrator-e2e-test/pull/49",
          "completedAt": "2026-01-19T22:27:36.010Z"
        }
      ],
      "reviewsAddressed": 0,
      "startedAt": "2026-01-19T22:21:51.099Z",
      "prNumber": 50,
      "prUrl": "https://github.com/mohsen1/claude-code-orchestrator-e2e-test/pull/50"
    },
    {
      "id": 2,
      "task": "Build RESTful API endpoints with Express server and routing",
      "focusArea": "API Layer",
      "branch": "cco/issue-46-em-2",
      "status": "workers_running",
      "workers": [
        {
          "id": 1,
          "task": "Create database layer with better-sqlite3 setup, tasks table schema with id (INTEGER PRIMARY KEY), title (TEXT), description (TEXT), due_date (TEXT), priority (TEXT), archived (INTEGER DEFAULT 0), created_at (TEXT), updated_at (TEXT). Implement initializeDatabase(), createTask(), getAllTasks(), getTaskById(), updateTask(), deleteTask() functions that use prepared statements. Export all functions and Database type.",
          "files": [
            "src/db.ts"
          ],
          "branch": "cco/issue-46-em-2-w-1",
          "status": "pr_created",
          "reviewsAddressed": 0,
          "startedAt": "2026-01-19T22:27:49.094Z",
          "prNumber": 54,
          "prUrl": "https://github.com/mohsen1/claude-code-orchestrator-e2e-test/pull/54",
          "completedAt": "2026-01-19T22:30:27.144Z"
        },
        {
          "id": 2,
          "task": "Create validation middleware using Zod. Define taskSchema object with title (string, min 1), description (optional string), due_date (optional date string), priority (enum 'low'|'medium'|'high'). Create validateRequest middleware that validates req.body against taskSchema and calls next() or returns 400 with { error: string }. Create errorHandler middleware that catches errors and sends { error: string } with appropriate status codes. Export both middleware.",
          "files": [
            "src/middleware/validation.ts",
            "src/middleware/error.ts"
          ],
          "branch": "cco/issue-46-em-2-w-2",
          "status": "pr_created",
          "reviewsAddressed": 0,
          "startedAt": "2026-01-19T22:30:27.852Z",
          "prNumber": 55,
          "prUrl": "https://github.com/mohsen1/claude-code-orchestrator-e2e-test/pull/55",
          "completedAt": "2026-01-19T22:31:39.693Z"
        },
        {
          "id": 3,
          "task": "Create Express server and task routes. In src/routes/tasks.ts: implement router with GET / (list tasks), GET /:id (single task), POST / (create task), PUT /:id (update task), DELETE /:id (soft delete). Import and use database functions and validation middleware. In src/index.ts: setup Express app with JSON parser, mount routes at /api/tasks, use error handler, listen on PORT env var or 3000. Export app for testing.",
          "files": [
            "src/index.ts",
            "src/routes/tasks.ts"
          ],
          "branch": "cco/issue-46-em-2-w-3",
          "status": "pending",
          "reviewsAddressed": 0
        }
      ],
      "reviewsAddressed": 0,
      "startedAt": "2026-01-19T22:21:51.099Z"
    },
    {
      "id": 3,
      "task": "Create middleware system for validation and error handling",
      "focusArea": "Middleware Infrastructure",
      "branch": "cco/issue-46-em-3",
      "status": "pending",
      "workers": [],
      "reviewsAddressed": 0,
      "startedAt": "2026-01-19T22:21:51.099Z"
    }
  ],
  "config": {
    "maxEms": 3,
    "maxWorkersPerEm": 3,
    "reviewWaitMinutes": 5,
    "prLabel": "cco"
  },
  "createdAt": "2026-01-19T22:21:43.265Z",
  "updatedAt": "2026-01-19T22:34:04.632Z",
  "error": "Failed to create PR from cco/issue-46-em-3 to cco/46-task-management-api-with-sqlite: Validation Failed: {\"resource\":\"PullRequest\",\"code\":\"custom\",\"message\":\"A pull request already exists for mohsen1:cco/issue-46-em-3.\"} - https://docs.github.com/rest/pulls/pulls#create-a-pull-request"
}